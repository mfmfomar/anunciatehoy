var socket=io.connect(location.host,{forceNew:!0}),appPerfil=new Vue({el:".table-responsive",created:function(){this.getUbicacionesUser()},data:{user:JSON.parse(localStorage.getItem("user")),data:{},options:{headers:{Authorization:localStorage.getItem("token")}},dataDelete:[],api:"../api/ubicacion"},methods:{getUbicacionesUser:function(){this.$http.get(this.api,this.options).then(function(e){this.data=e.data})},deleteItem:function(){0<this.dataDelete.length&&this.$http.delete(this.api,{headers:{Authorization:localStorage.getItem("token")},body:this.dataDelete}).then(function(e){for(i=0;i<this.dataDelete.length;i++){var t=this.dataDelete[i].split("@");if("propiedad"==t[1])for(j=0;j<this.data.propiedad.length;j++)this.data.propiedad[j]._id==t[0]&&(socket.emit("deleteProperty",this.data.propiedad[j]),this.data.propiedad.splice(j,1));else if("hospedaje"==t[1])for(j=0;j<this.data.hospedaje.length;j++)this.data.hospedaje[j]._id==t[0]&&(socket.emit("deleteProperty",this.data.propiedad[j]),this.data.hospedaje.splice(j,1))}this.dataDelete=[]},function(e){e.body.message;console.error(e.body)}).catch(function(e){console.error("Caught",e)})},interruptor:function(e){this.data.hospedaje[e].disponibilidad=!this.data.hospedaje[e].disponibilidad,this.$http.put(this.api,this.data.hospedaje[e],{headers:{Authorization:localStorage.getItem("token")}}).then(function(e){socket.emit("upDateUbicacion",e.data.propiedad),console.log(e)})}}});$(document).ready(function(){"use strict";function e(e){e.element;return e.id?"<i class='"+$(e.element).data("icon")+"'></i>"+e.text:e.text}$("#eliminar").click(function(){this.hijos=$(".table-responsive").find(".dt-checkboxes"),this.hijos.each(function(){$(this).is(":checked")&&appPerfil.dataDelete.push($(this).parent().parent().attr("index")+"@"+$(this).parent().parent().attr("tabla"))}),$("#myModal").modal("toggle")}),$("#add-new-data-sidebar").submit(function(e){var t=$("#add-new-data-sidebar");if(event.preventDefault(),event.stopPropagation(),!1===t[0].checkValidity());else{t.addClass("was-validated");var a=$("#add-new-data-sidebar").serializeArray();updateImage.enviar(a)}}),$("#nuevo").click(function(e){$("#enviar").click()});$(".data-list-view").DataTable({responsive:!1,columnDefs:[{orderable:!0,targets:0,checkboxes:{selectRow:!0}}],dom:'<"top"<"actions action-btns"B><"action-filters"lf>><"clear">rt<"bottom"<"actions">p>',oLanguage:{sLengthMenu:"_MENU_",sSearch:""},aLengthMenu:[[4,10,15,20],[4,10,15,20]],select:{selector:"td:first-child",style:"multi"},order:[[1,"asc"]],bInfo:!1,pageLength:4,buttons:[{text:"<div data-i18n='A単adir nuevo' ><i class='feather icon-plus'></i> A単adir nuevo</div>",action:function(){location.href="/nuevaUbicacion"},className:"btn-outline-primary"}],initComplete:function(e,t){$(".dt-buttons .btn").removeClass("btn-secondary")}}),$(".data-thumb-view").DataTable({responsive:!1,columnDefs:[{orderable:!0,targets:0,checkboxes:{selectRow:!0}}],dom:'<"top"<"actions action-btns"B><"action-filters"lf>><"clear">rt<"bottom"<"actions">p>',oLanguage:{sLengthMenu:"_MENU_",sSearch:""},aLengthMenu:[[4,10,15,20],[4,10,15,20]],select:{selector:"td:first-child",style:"multi"},order:[[1,"asc"]],bInfo:!1,pageLength:4,buttons:[{text:"<div data-i18n='A単adir nuevo'><i class='feather icon-plus'></i> A単adir nuevo</div",action:function(){$(this).removeClass("btn-secondary"),$(".add-new-data").addClass("show"),$(".overlay-bg").addClass("show")},className:"btn-outline-primary"}],initComplete:function(e,t){$(".dt-buttons .btn").removeClass("btn-secondary")}});$(".actions-dropodown").insertBefore($(".top .actions .dt-buttons")),$(".data-list-view, .data-thumb-view").on("click","tbody td",function(){var e=$(this).parent("tr").find(".dt-checkboxes-cell .dt-checkboxes");$(this).closest("tr").toggleClass("selected"),e.prop("checked",!e.prop("checked"))}),$(".dt-checkboxes").on("click",function(){$(this).closest("tr").toggleClass("selected")}),$(".dt-checkboxes-select-all input").on("click",function(){$(".data-list-view").find("tbody tr").toggleClass("selected"),$(".data-thumb-view").find("tbody tr").toggleClass("selected")}),0<$(".data-items").length&&new PerfectScrollbar(".data-items",{wheelPropagation:!1}),$(".hide-data-sidebar, .cancel-data-btn").on("click",function(){$(".add-new-data").removeClass("show"),$(".overlay-bg").removeClass("show"),$("#data-name, #data-price").val(""),$("#data-category, #data-status").prop("selectedIndex",0)}),-1!=navigator.userAgent.indexOf("Mac OS X")&&$(".dt-checkboxes-cell input, .dt-checkboxes").addClass("mac-checkbox"),$(".select2-icons").select2({minimumResultsForSearch:1/0,templateResult:e,templateSelection:e,escapeMarkup:function(e){return e}})});