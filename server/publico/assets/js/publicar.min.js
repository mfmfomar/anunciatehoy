function updateImagecomplete(){$("#myModalanuncio_publicado").modal("toggle")}updateImage=function(e,o){var a,n,i,t;return t=0,Dropzone.autoDiscover=!1,Dropzone.options.portadaForm={headers:{Authorization:localStorage.getItem("token")},maxFilesize:1,parallelUploads:10,uploadMultiple:!0,autoProcessQueue:!1,addRemoveLinks:!0,maxFiles:e,dictResponseError:"Server not Configured",acceptedFiles:".png,.jpg,.gif,.bmp,.jpeg",paramName:"fileImage",init:function(){var e=this;e.options.addRemoveLinks=!0,e.options.dictRemoveFile="Delete",e.on("addedfile",function(e){$(".dz-preview").first().addClass("DZportada"),n=$(".DZportada>.dz-details>.dz-filename>span").html(),$("#imgPortada").val(n),t++,$("#foto").val(t),console.log("new file added ",e)}),e.on("sending",function(e,o,a){a.append("portadaName",n),$("#imgPortada").val(n);for(var t=0;t<i.length;t++)a.append(i[t].name,i[t].value);console.log("upload started",e)}),e.on("totaluploadprogress",function(e){console.log("progress ",e),$("#progres").width(e+"%")}),e.on("complete",function(e){console.log("complete"),0===this.getUploadingFiles().length&&0===this.getQueuedFiles().length&&(console.log("complete All"),o())}),e.on("success",function(e,o){console.log("done"),a.options.autoProcessQueue=!0}),e.on("removedfile",function(e){console.log(e),t--,$(".dz-preview").first().addClass("DZportada"),n=$(".DZportada>.dz-details>.dz-filename>span").html(),$("#imgPortada").val(n),t<1&&$("#foto").val("")})}},a=new Dropzone("#portadaForm"),{enviar:function(e){i=e,a.processQueue()},portadaName:function(){return console.log(n),n}}};var form=$(".steps-validation").show();$(".steps-validation").steps({headerTag:"h6",bodyTag:"fieldset",transitionEffect:"fade",titleTemplate:'<span class="step">#index#</span> #title#',labels:{finish:"Submit"},onStepChanging:function(e,o,a){return a<o||(o<a&&(form.find(".body:eq("+a+") label.error").remove(),form.find(".body:eq("+a+") .error").removeClass("error")),form.validate().settings.ignore=":disabled,:hidden",form.valid())},onFinishing:function(e,o){return form.validate().settings.ignore=":disabled",form.valid()},onFinished:function(e,o){var a=$("#add-new-data-sidebar").serializeArray(),t=[];$.ajax({type:"POST",url:"/api/nuevoAnuncio",headers:{Authorization:localStorage.getItem("token")},data:a}).done(function(e){t[0]={name:"id",value:e.codigo},updateImage.enviar(t)})}}),$(".steps-validation").validate({ignore:"input[type=hidden]",errorClass:"danger",successClass:"success",highlight:function(e,o){$(e).removeClass(o)},unhighlight:function(e,o){$(e).removeClass(o)},errorPlacement:function(e,o){e.insertAfter(o)},rules:{email:{email:!0}}});var updateImage=new updateImage(10,updateImagecomplete);$(document).ready(function(){"use strict";function e(e){e.element;return e.id?"<i class='"+$(e.element).data("icon")+"'></i>"+e.text:e.text}$("#nuevo").click(function(e){$("#enviar").click()}),$(".select2-icons").select2({minimumResultsForSearch:1/0,templateResult:e,templateSelection:e,escapeMarkup:function(e){return e}})});